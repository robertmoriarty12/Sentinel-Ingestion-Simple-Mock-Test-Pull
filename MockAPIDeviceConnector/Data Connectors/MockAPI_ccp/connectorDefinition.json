{
  "name": "MockAPIDeviceConnector",
  "apiVersion": "2024-01-01-preview",
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "MockAPIDeviceConnector",
      "title": "Mock API Device Connector",
      "publisher": "Test Publisher",
      "descriptionMarkdown": "This connector ingests device data from a mock API endpoint for testing purposes.",
      "graphQueriesTableName": "MockAPIDevices_CL",
      "graphQueries": [
        {
          "metricName": "Total events received",
          "legend": "Mock API Device Events",
          "baseQuery": "{{graphQueriesTableName}}"
        }
      ],
      "sampleQueries": [
        {
          "description": "Get all device records",
          "query": "MockAPIDevices_CL | take 10"
        }
      ],
      "dataTypes": [
        {
          "name": "{{graphQueriesTableName}}",
          "lastDataReceivedQuery": "{{graphQueriesTableName}} | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors"
        }
      ],
      "availability": {
        "status": 1,
        "isPreview": true
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "read and write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "write": true,
              "read": true,
              "delete": true
            }
          },
          {
            "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
            "permissionsDisplayText": "read permissions to shared keys for the workspace are required.",
            "providerDisplayName": "Keys",
            "scope": "Workspace",
            "requiredPermissions": {
              "action": true
            }
          }
        ],
        "customs": [
          {
            "name": "Mock API Key",
            "description": "An API key from the mock API service is required."
          }
        ]
      },
      "instructionSteps": [
        {
          "instructions": [
            {
              "type": "Markdown",
              "parameters": {
                "content": "#### Configuration steps for Mock API\nProvide your Mock API endpoint URL and API key to start ingesting device data."
              }
            },
            {
              "parameters": {
                "label": "Mock API Endpoint URL",
                "placeholder": "https://mockbin.io/bin/your-endpoint",
                "type": "text",
                "name": "apiEndpoint"
              },
              "type": "Textbox"
            },
            {
              "parameters": {
                "label": "API Key",
                "placeholder": "Enter your API key",
                "type": "securestring",
                "name": "apiKey"
              },
              "type": "Textbox"
            },
            {
              "parameters": {
                "label": "toggle",
                "name": "toggle"
              },
              "type": "ConnectionToggleButton"
            }
          ]
        }
      ]
    }
  }
}
